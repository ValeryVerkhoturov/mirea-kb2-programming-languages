% Compiler: XeLaTeX
\documentclass[14pt, a4paper, titlepage]{extarticle}

\usepackage[english,main=russian]{babel}
\usepackage{fontspec}
\setmainfont{Times New Roman} % Если возникают проблемы при компиляции с данной строкой, необходимо установить необходимый 
\usepackage{newtxmath} % Поменять гарнитуру в фомулах на Times New Roman

\usepackage[left=30mm, right=15mm, top=20mm, bottom=20mm]{geometry}

\usepackage{indentfirst} % Красная строка у первого абзаца раздела

\usepackage{graphicx}

\parindent=1.25cm % Размер красной строки

\parskip=6pt % Отступ между абзацами

\righthyphenmin=2 % Разрешить переносить слоги в 2 буквы (стандартное значение 3)

\linespread{1.3} % полуторный межстрочный интервал

\usepackage{tocbibind} % Добавить раздел оглавление в оглавление

% Настройка заголовка оглавления
\addto\captionsrussian{\renewcommand{\contentsname}{Оглавление}}


\usepackage{tocloft}
% Формат оглавления
\renewcommand\cfttoctitlefont{\hfill\fontsize{16pt}{16pt}\selectfont\bfseries\MakeUppercase}
\renewcommand\cftaftertoctitle{\hfill\hfill}

\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}} % Добавить точки у разделов в оглавлении

% Настройка раздела, подраздела, подподраздела
\usepackage{titlesec}
\titleformat{\section}{\filcenter\fontsize{16pt}{16pt}\selectfont\bfseries\uppercase}{\thesection}{.2em}{}
\titleformat{\subsection}{\filcenter\bfseries}{\thesubsection}{.2em}{}
\titleformat{\subsubsection}{\filcenter\bfseries}{\thesubsubsection}{.2em}{}

\AddToHook{cmd/section/before}{\clearpage} % Начинать раздел с новой страницы

\renewenvironment{abstract}{\clearpage\section*{\MakeUppercase{\abstractname}}}{\clearpage}

\labelwidth=1.25cm % Горизонтальный отступ у элемента списка

% Ненумерованные списки разной вложенности
\renewcommand\labelitemi{--}
\renewcommand\labelitemii{--}
\renewcommand\labelitemiii{--}
\renewcommand\labelitemiv{--}

% Нумерованные списки разной вложенности
\renewcommand\labelenumi{\arabic{enumi})}
\renewcommand\labelenumii{\asbuk{enumii})}
\renewcommand\labelenumiii{\arabic{enumiii})}
\renewcommand\labelenumiv{\asbuk{enumiv})}

\makeatletter
% Буквы для нумерации списка (исключены ё, з, щ, ч, ъ, ы, ь)
% Подробнее https://ctan.math.illinois.edu/macros/latex/required/babel/contrib/russian/russianb.pdf 
\def\russian@alph#1{\ifcase#1\or
    а\or б\or в\or г\or д\or е\or ж\or
    и\or к\or л\or м\or н\or о\or п\or 
    р\or с\or т\or у\or ф\or х\or ц\or 
    ш\or э\or ю\or я\else\@ctrerr\fi}
\def\russian@Alph#1{\ifcase#1\or
    А\or Б\or В\or Г\or Д\or Е\or Ж\or
    И\or К\or Л\or М\or Н\or О\or П\or 
    Р\or С\or Т\or У\or Ф\or Х\or Ц\or 
    Ш\or Э\or Ю\or Я\else\@ctrerr\fi}

\patchcmd{\l@section}{#1}{\textnormal{\uppercase{#1}}}{}{} % Разделы в оглавлении без выделения жирным, в верхнем регистре
\patchcmd{\l@section}{#2}{\textnormal{#2}}{}{} % Страницы без выделения жирным

\apptocmd{\appendix}{
    \renewcommand{\thesection}{\Asbuk{section}}
    \titleformat{\section}{\filcenter\fontsize{16pt}{16pt}\selectfont\bfseries}{}{0pt}{\MakeUppercase{\appendixname}~\thesection \\}{}{} % Изменение формата раздела приложения
    
    \let\oldsec\section
    \renewcommand{\section}{
        \clearpage
        \phantomsection
        \refstepcounter{section}
        \addcontentsline{toc}{section}{\appendixname~\thesection}
        \oldsec*} % Нумерация раздела после названия
}
\makeatother

\usepackage[labelsep=endash]{caption} % Настройка пунктуации
\captionsetup[table]{justification=raggedright, singlelinecheck=false} % Выравнивание по левому краю надписи таблицы

\addto\captionsrussian{\renewcommand{\figurename}{Рисунок}} % Переопределение caption из babel

% Пакет делает ссылки кликабельными и дает возможность добавить метаданные .pdf документа
\usepackage{hyperref}
% Метаданные .pdf документа, отключение подсветки ссылок
\hypersetup{pdftitle={Языки программирования}, pdfauthor={В. С. Верхотуров}, colorlinks=false, pdfborder={0 0 0}}

\usepackage{csquotes} % используется biblatex
\usepackage[
    backend=biber,
    bibstyle=gost-numeric,
    language=auto,
    autolang=other,
    sorting=none,
]{biblatex}

\pretocmd{\printbibliography}{
    \clearpage
    \addcontentsline{toc}{section}{Список использованных источников}}{}{}

\let\oldprintbibliography\printbibliography
\renewcommand{\printbibliography}{\oldprintbibliography[title={Список использованных источников}]}

% Перечисление использованных источников в biblatex
% Подробнее https://www.ctan.org/pkg/biblatex-gost
\begin{filecontents*}[overwrite]{biblio.bib}
    @book{bib:recomendations,
      author = {Мерсов, А.А. and Русаков, А.М. and Филатов, В.В.},
      year = {2022},
      title = {Методические рекомендации по выполнению курсовой работы по дисциплине <<Языки программирования>>},
      publisher = {МИРЭА --- Российский технологический университет},
      chapter=3
    }
    @online{bib:symbol,
      author = {РТУ~МИРЭА},
      title = {Символика Университета},
      year = 2022,
      url = {https://www.mirea.ru/mediapage/the-symbolism-of-the-university/},
      urldate = {2022-05-31}
    }
    @online{bib:githubrepo,
      author = {Верхотуров, В. С.},
      title = {LaTeX шаблон для курсовой работы по дисциплине <<Языки программирования>> РТУ МИРЭА},
      year = 2022,
      url = {https://github.com/ValeryVerkhoturov/mirea-kb2-programming-languages},
      urldate = {2022-05-29}
    }
\end{filecontents*}
\addbibresource{biblio.bib}

\begin{document}

\begin{titlepage}
    \begin{center}
        \includegraphics[width=2.5cm]{MIREA_Gerb_Black.eps} \\
        МИНОБРНАУКИ РОССИИ \\ 
        Федеральное государственное бюджетное образовательное учреждение высшего образования \\
        \textbf{<<МИРЭА --- Российский технологический университет>>} \\
        \textbf{\fontsize{16pt}{16pt}\selectfont{}РТУ МИРЭА}\\
        Институт кибербезопасности и цифровых технологий \\
        Кафедра КБ-14 <<Цифровые технологии обработки данных>> \\
        \begin{flushright}
        Утверждаю \\
        Заведующий кафедрой КБ-2 \\
        Фамилия И.О.\quad\underline{\qquad\qquad}\\
        \underline{<<\qquad>>\qquad\qquad\the\year{} г.}
        \end{flushright}
        \fontsize{16pt}{16pt}\selectfont
        \textbf{КУРСОВАЯ РАБОТА} \\
        по дисциплине \textbf{Языки программирования}
    \end{center}
    \textbf{Тема курсовой работы <<Разработка файловой базы данных студентов на основе принципов ООП>>} \\
    \begin{tabular}{@{}lr}
        Студент группы БСБО-05-20 Верхотуров Валерий Сергеевич & \underline{\phantom{\qquad\qquad}} \\
        Руководитель курсового проекта (работы) \hrulefill & \hrulefill \\
        Рецензент (при наличии) \hrulefill & \hrulefill \\
    \end{tabular}\\
    \noindent{}Работа предоставлена к защите <<\underline{\qquad}>> июня \the\year{} г.\\
    \noindent{}Допущен к защите <<\underline{\qquad}>> июня \the\year{} г.\\
    \begin{center}
        \vfill{}Москва -- \the\year{} г.
    \end{center}
    \newpage
    \noindent\textbf{Срок предоставления к защите курсовой работы до} \underline{<<\qquad>>\qquad\quad\the\year{} г.}\\
    \textbf{Задание на курсовую работу выдал} Фамилия И.О. \hfill\underline{\qquad\qquad}
    \begin{flushright}
        \underline{<<\qquad>>\qquad\qquad\the\year{} г.}
    \end{flushright}
    \noindent\textbf{Задание на курсовую работу получил} Фамилия И.О. \hfill\underline{\qquad\qquad} \\
    \begin{center}
        \bigskip{}Москва -- \the\year{} г.
    \end{center}
    \thispagestyle{empty}
\end{titlepage}
\addtocounter{page}{2}

\begin{abstract}
    Этот документ имеет настройки, соответствующие главе 3 у\-чеб\-но-ме\-то\-ди\-чес\-ко\-го пособия~\cite{bib:recomendations}, скомпилированный системой компьютерной вёрстки Xe\LaTeX{} из дистрибутива TeX Live. Ссылки кликабельны.
    
    В этом документ использованы только пакеты для форматирования (исключение --- graphicx) и библиографии. Новые пользовательские макрокоманды не объявлены. В родительской директории этого \verb".tex" файла должен лежать файл герба (черно-белый) \verb"MIREA_Gerb_Black.eps"~\cite{bib:symbol}. Настройки форматирования, библиографический список находятся в преамбуле (при удалении всего содержимого в окружении document настройки форматирования не изменятся).
    
    При использовании \url{overleaf.com} убедитесь, что в опциях проекта стоит компилятор XeLaTeX. 
    
    Замечания о расхождении с учебно-методическим пособием~\cite{bib:recomendations} писать в Issues репозитория~\cite{bib:githubrepo}.
    
    \subsection*{.tex в .docx}
    
    Раздел 1.1 СМКО МИРЭА 7.5.1/03.П.69-16 рекомендует использовать текстовый редактор, обеспечивающий корректное сохранение или экспорт документа в .doc (.docx). .tex не может быть напрямую экспортирован в .doc (.docx). Возможно скомпилировать .pdf, сохранить в Google Документы и экспортировать в .docx. При этом форматирование документа не сохраняется, математические формулы экспортируются некорректно.
    
    \subsection*{Метаданные .pdf}
    
    Не забудьте в преамбуле в команде \verb"\hypersetup" поменять значение полей \verb"pdftitle={"Название моего документа\verb"}", \verb"pdfauthor={"Мое имя\verb"}".
    
\end{abstract}

\tableofcontents

\section{Структура документа}

Структура документа совместима со стандартным классом документа \LaTeX{} article.

\subsection{Титульная страница}

Рекомендуется использовать выданные преподавателем титульные страницы (например, с помощью пакета pdfpages).
    
При использованих своих титульных страниц необходимо удалить окружение titlepage:

\begin{verbatim}
\begin{titlepage}
...
\end{titlepage}
\end{verbatim}
класс документа поменять на

\begin{verbatim}
\documentclass[14pt, a4paper]{extarticle} 
\end{verbatim}

К основному тексту после титульных листов необходимо добавить кол-во вставленных страниц. Пример:
\begin{verbatim}
\begin{titlepage}
...
\end{titlepage}
\addtocounter{page}{2}
\end{verbatim}

\subsection{Аннотация}

\begin{verbatim}
\begin{abstract}
...
\end{abstract}
\end{verbatim}

\subsection{Оглавление}

\begin{verbatim}
\tableofcontents
\end{verbatim}

\subsection{Раздел}

\begin{verbatim}
\section{...}
\end{verbatim}

\subsection{Подраздел}

\begin{verbatim}
\subsection{...}
\end{verbatim}

\subsection{Пункт}

\begin{verbatim}
\subsubsection{...}
\end{verbatim}

\subsection{Список использованных источников}

\begin{verbatim}
\printbibliography
\end{verbatim}

Данный документ создан на основе рекомендаций~\parencite{bib:recomendations}.

\subsection{Приложение}

Как и в стандартных классах перед приложениями необходимо указать команду \verb"\appendix{}".

Пример с одним приложением:

\begin{verbatim}
\appendix
\section{...}
...
\end{verbatim}

Пример с тремя приложениями:

\begin{verbatim}
\appendix
\section{...}
...
\section{...}
...
\section{...}
...
\end{verbatim}

Ссылка на приложение~\ref{appendix:test_label}.

За порядком приложений необходимо следить самостоятельно.

\subsection{Списки и перечисления}

\begin{verbatim}
\begin{itemize}
    \item ...
\end{itemize}
\end{verbatim}

\begin{itemize}
    \item первый уровень вложенности,
    \begin{itemize}
        \item второй,
        \begin{itemize}
            \item третий,
            \begin{itemize}
                \item четвертый.
            \end{itemize}
        \end{itemize}
    \end{itemize}
\end{itemize}

\begin{verbatim}
\begin{enumerate}
    \item ...
\end{enumerate} 
\end{verbatim}

\begin{enumerate}
    \item первый уровень вложенности,
    \begin{enumerate}
        \item второй,
        \begin{enumerate}
            \item третий,
            \begin{enumerate}
                \item четвертый,
                \item б,
                \item в,
                \item г,
                \item д,
                \item е,
                \item ж,
                \item и,
                \item к,
                \item л,
                \item м,
                \item н,
                \item о,
                \item п,
                \item р,
                \item с,
                \item т,
                \item у,
                \item ф,
                \item x,
                \item ц,
                \item ш,
                \item э,
                \item ю,
                \item я, при наличии большего кол-ва элементов компилятор выдаст ошибку.
            \end{enumerate}
        \end{enumerate}
    \end{enumerate}
\end{enumerate}

\subsection{Иллюстрация}

\begin{figure}[htb!]
    \centering
    \includegraphics[width=.5\textwidth]{MIREA_Gerb_Black.eps}
    \caption{Подпись ниже рисунка по центру}
    \label{fig:test_label}
\end{figure}
 
Пакет graphix подключен. См. рисунок~\ref{fig:test_label} на стр.~\pageref{fig:test_label}. 

Обратите внимание, что окружение figure является плавающим, и иллюстрация может появиться не там, где Вы ожидаете. Для размещения иллюстрации в конкретное место необходимо воспользоваться опцией H из пакета float (не подключен).

\subsection{Таблица}

\begin{table}[htb]
    \caption{Подпись выше таблицы слева}
    \centering
    \begin{tabular}{ |c|c|c|c|c| } 
        \hline
        ячейка 1 & ячейка 2 & ячейка 3 & ячейка 4 & ячейка 5 \\ \hline
        ячейка 6 & ячейка 7 & ячейка 8 & ячейка 9 & ячейка 10 \\ \hline
    \end{tabular}
    \label{tab:test_label}
\end{table}
 
См. таблицу~\ref{tab:test_label} на стр.~\pageref{tab:test_label}.

Обратите внимание, что окружение table является плавающим, и таблица может появиться не там, где Вы ожидаете. Для размещения иллюстрации в конкретное место необходимо воспользоваться опцией H из пакета float (не подключен).

\subsection{Уравнение и формула}

\begin{equation}\label{eq:test_label}
    (\text{минус}\,a)\times b=c ,
\end{equation}
где $a$ --- первая переменная; \\
$b$ --- вторая переменная; \\
$c$ --- третья переменная.

См. формулу~\ref{eq:test_label}.

\printbibliography

\appendix

\section{Название первого приложения}
\label{appendix:test_label}

\section{Название второго приложения}

\end{document}
