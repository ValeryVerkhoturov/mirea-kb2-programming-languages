% Compiler: XeLaTeX
\documentclass[14pt, a4paper, titlepage]{extarticle}

\usepackage[english,main=russian]{babel}
\usepackage{fontspec}
\setmainfont{Times New Roman} % Если возникают проблемы при компиляции с данной строкой, необходимо установить необходимый 
\usepackage{newtxmath} % Поменять гарнитуру в фомулах на Times New Roman

\usepackage[left=30mm, right=15mm, top=20mm, bottom=20mm]{geometry}

\usepackage{csquotes} % используется biblatex
\usepackage[
    backend=biber,
    bibstyle=gost-numeric,
    language=auto,
    autolang=other,
    sorting=none,
]{biblatex}

% Перечисление использованных источников в biblatex
\begin{filecontents*}[overwrite]{biblio.bib}
    @book{bib:recomendations,
      author = {Мерсов, А. А. and Русаков, А. М. and Филатов, В. В.},
      year = {2022},
      title = {Методические рекомендации по выполнению курсовой работы по дисциплине <<Языки программирования>>},
      publisher = {МИРЭА --- Российский технологический университет},
    }
    @online{bib:mntemplate,
      author = {Mirea~Ninja},
      title = {LaTeX шаблон для написания отчетов/дипломов/курсовых работ},
      url = {https://github.com/mirea-ninja/Latex-Template-for-Report-Diploma-Thesis},
      urldate = {2022-05-29}
    }
    @online{bib:prince,
      author = {Сент-Экзюпери, Антуан},
      title = {Маленький принц},
      year = 1943,
      url = {http://www.chertyaka.ru/detskie_skazki/exuperi/malenkii_princ8.php},
      urldate = {2022-05-29}
}
\end{filecontents*}
\addbibresource{biblio.bib}

\usepackage{indentfirst} % Красная строка у первого абзаца раздела

\usepackage{graphicx}

\parindent=1.25cm % Размер красной строки

\parskip=6pt % Отступ между абзацами

\righthyphenmin=2 % Разрешить переносить слоги в 2 буквы (стандартное значение 3)

\linespread{1.3} % Межстрочный интервал 1.5

\usepackage{tocbibind} % Добавить раздел содержание в содержание

% Настройка заголовка содержания
\usepackage{tocloft}
\renewcommand\cfttoctitlefont{\hfill\fontsize{16pt}{16pt}\selectfont\bfseries\MakeUppercase}
\renewcommand\cftaftertoctitle{\hfill\hfill}

% Настройка раздела, подраздела, подподраздела
\usepackage{titlesec}
\titleformat{\section}{\clearpage\filcenter\fontsize{16pt}{16pt}\selectfont\bfseries\uppercase}{\thesection}{.2em}{}
\titleformat{\subsection}{\filcenter\bfseries}{\thesubsection}{.2em}{}
\titleformat{\subsubsection}{\filcenter\bfseries}{\thesubsubsection}{.2em}{}

\renewenvironment{abstract}{\clearpage\section*{\MakeUppercase{\abstractname}}}{}

\labelwidth=1.25cm % Горизонтальный отступ у элемента списка

% Ненумерованные списки разной вложенности
\renewcommand\labelitemi{--}
\renewcommand\labelitemii{--}
\renewcommand\labelitemiii{--}
\renewcommand\labelitemiv{--}

% Нумерованные списки разной вложенности
\renewcommand\labelenumi{\arabic{enumi})}
\renewcommand\labelenumii{\asbuk{enumii})}
\renewcommand\labelenumiii{\arabic{enumiii})}
\renewcommand\labelenumiv{\asbuk{enumiv})}

\makeatletter
% Буквы для нумерации списка (исключены ё, з, щ, ч, ъ, ы, ь
% Подробнее https://ctan.math.illinois.edu/macros/latex/required/babel/contrib/russian/russianb.pdf 
\def\russian@alph#1{\ifcase#1\or
    а\or б\or в\or г\or д\or е\or ж\or
    и\or к\or л\or м\or н\or о\or п\or 
    р\or с\or т\or у\or ф\or х\or ц\or 
    ш\or э\or ю\or я\else\@ctrerr\fi}
    
\patchcmd{\l@section}{#1}{\MakeUppercase{#1}}{}{} % Разделы в содержании в верхнем регистре
\makeatother

\usepackage[labelsep=endash]{caption} % Настройка пунктуации
\captionsetup[table]{justification=raggedright, singlelinecheck=false} % Выравнивание по левому краю надписи таблицы

\addto\captionsrussian{\renewcommand{\figurename}{Рисунок}} % Переопределение caption из babel

% Пакет делает ссылки кликабельными и дает возможность добавить метаданные .pdf документа
\usepackage{hyperref}
% Метаданные .pdf документа, отключение подсветки ссылок
\hypersetup{pdftitle={Языки программирования}, pdfauthor={В. С. Верхотуров}, colorlinks=false, pdfborder={0 0 0}}


\begin{document}

% Желательно использовать выданный преподавателем титульник. См. как https://www.ctan.org/pkg/pdfpages
% При использовании своего титульника удалить окружение titlepage (\begin{titlepage}...\end{titlepage}), класс документа поменять с \documentclass[14pt, a4paper, titlepage]{extarticle} на \documentclass[14pt, a4paper]{extarticle}
\begin{titlepage}
    \begin{center}
        \includegraphics{mirea_coat_of_arms.png} \\
        МИНОБРНАУКИ РОССИИ \\ 
        Федеральное государственное бюджетное образовательное учреждение высшего образования \\
        \textbf{<<МИРЭА --- Российский технологический университет>>} \\
        \textbf{РТУ МИРЭА}
        \rule{\textwidth}{1pt}
        Институт кибербезопасности и цифровых технологий \\
        Кафедра КБ-14 <<Цифровые технологии обработки данных>> \\ \bigskip
        \fontsize{16pt}{16pt}\selectfont
        \textbf{КУРСОВОЙ ПРОЕКТ (РАБОТА)} \\ \bigskip \bigskip
        по дисциплине: \textbf{<<Языки программирования>>} \\ \bigskip \bigskip
        \textbf{Тема курсового проекта (работы):} \\
        <<Разработка файловой базы данных студентов на основе принципов ООП>>
    \end{center}
    \noindent\textbf{Студент группы} {\fontsize{16pt}{16pt}\selectfont БСБО-05-20 Верхотуров Валерий Сергеевич}\par
    \noindent\textbf{Руководитель курсового проекта (работы)} {\fontsize{16pt}{16pt}\selectfont Должность, звание, ученая степень}\par
    \noindent\textbf{Рецензент} {\fontsize{16pt}{16pt}\selectfont Должность, звание, ученая степень}\par
    \centering\vfill 
    Москва \the\year{} г.
\end{titlepage}

\begin{abstract}
    Вы читаете документ, имеющий настройки, отвечающие рекомендациям~\cite{bib:recomendations}, и скомпилированный системой компьютерной верстки Xe\LaTeX{} из дистрибутива TeX Live.
    
    Рекомендуется использовать Overleaf для компиляции документа (убедитесь, что в опциях проекта стоит компилятор XeLaTeX, иначе не компилируется).
    
    Этот документ не имеет заранее использованных пакетов и определенных макрокоманд для пользователя, в родительской директории этого \verb".tex" файла должна лежать картинка герба университета {\\\centering mirea\_coat\_of\_arms.png.\\} Более дружелюбный шаблон, но отвечающий не всем рекомендациям~\cite{bib:recomendations} является \cite{bib:mntemplate}.
    
    По замечаниям в форматировании писать в Issues \url{https://github.com/ValeryVerkhoturov/mirea-kb2-programming-languages}.
    
    \textbf{tex в docx}
    
    Согласно разделу 1.1 СМКО МИРЭА 7.5.1/03.П.69-16 требуется формат .doc(.docx), .tex не может быть напрямую экспортирован в .doc(.docx). Возможно скомпилировать .pdf, сохранить в Google Документы и экспортировать в .docx.

    \textbf{Об \texttt{abstract}}
    
    Окружение abstract переопределено и является алиасом: \\ \verb"\clearpage\section*{\MakeUppercase{\abstractname}}", \\ окружение можно заменить на привычную команду: \\ \verb"\section*{"Аннотация\verb"}".
    
    В случае отсутствия аннотации удалить окружение abstract: \\\verb"\begin{abstract} ... \end{abstract}".
\end{abstract}

\clearpage
\tableofcontents

\section{Пример вёрстки}

Очень скоро я лучше узнал этот цветок. На планете Маленького принца всегда росли простые, скромные цветы~--- у них было мало лепестков, они занимали совсем мало места и никого не беспокоили. Они раскрывались поутру в траве и под вечер увядали. А этот пророс однажды из зерна, занесенного неведомо откуда, и Маленький принц не сводил глаз с крохотного ростка, не похожего на все остальные ростки и былинки. Вдруг это какая-нибудь новая разновидность баобаба? Но кустик быстро перестал тянуться ввысь, и на нем появился бутон. Маленький принц никогда еще не видал таких огромных бутонов и предчувствовал, что увидит чудо. А неведомая гостья, скрытая в стенах своей зеленой комнатки, все готовилась, все прихорашивалась. Она заботливо подбирала краски. Она наряжалась неторопливо, один за другим примеряя лепестки. Она не желала явиться на свет встрепанная, точно какой-нибудь мак. Она хотела показаться во всем блеске своей красоты. Да, это была ужасная кокетка! Таинственные приготовления длились день за днем. И вот однажды утром, едва взошло солнце, лепестки раскрылись~\cite{bib:prince}.

\subsection{Подраздел}

И красавица, которая столько трудов положила, готовясь к этой минуте, сказала, позевывая:

--- Ах, я насилу проснулась\dots{} Прошу извинить\dots{} Я еще совсем растрепанная\dots{}

Маленький принц не мог сдержать восторга:

--- Как вы прекрасны!

--- Да, правда?~--- был тихий ответ.~--- И заметьте, я родилась вместе с солнцем.

Маленький принц, конечно, догадался, что удивительная гостья не страдает избытком скромности, зато она была так прекрасна, что дух захватывало!

А она вскоре заметила:

--- Кажется, пора завтракать. Будьте так добры, позаботьтесь обо мне\dots{}

Маленький принц очень смутился, разыскал лейку и полил цветок ключевой водой.

Скоро оказалось, что красавица горда и обидчива, и Маленький принц совсем с ней измучился. У нее было четыре шипа, и однажды она сказала ему:

--- Пусть приходят тигры, не боюсь я их когтей!

--- На моей планете тигры не водятся,~--- возразил Маленький принц.~--- И потом, тигры не едят траву~\cite{bib:prince}.

\subsubsection{Подподраздел}

--- Я не трава,~--- тихо заметил цветок.

--- Простите меня\dots{}

--- Нет, тигры мне не страшны, но я ужасно боюсь сквозняков. У вас нет ширмы?

--- Растение, а боится сквозняков\dots{} очень странно\dots{}~--- подумал Маленький принц.~--- Какой трудный характер у этого цветка.

--- Когда настанет вечер, накройте меня колпаком. У вас тут слишком холодно. Очень неуютная планета. Там, откуда я прибыла\dots{}

Она не договорила. Ведь ее занесло сюда, когда она была еще зернышком. Она ничего не могла знать о других мирах. Глупо лгать, когда тебя так легко уличить! Красавица смутилась, потом кашлянула раз-другой, чтобы Маленький принц почувствовал, как он перед нею виноват:

--- Где же ширма?

--- Я хотел пойти за ней, но не мог же я вас не дослушать!

Тогда она закашляла сильнее: пускай его все-таки помучит совесть!

Хотя Маленький принц и полюбил прекрасный цветок, и рад был ему служить, но вскоре в душе его пробудились сомнения. Пустые слова он принимал близко к сердцу и стал чувствовать себя очень несчастным.

--- Напрасно я ее слушал,~--- доверчиво сказал он мне однажды.~--- Никогда не надо слушать, что говорят цветы. Надо просто смотреть на них и дышать их ароматом. Мой цветок напоил благоуханием всю мою планету, а я не умел ему радоваться. Эти разговоры о когтях и тиграх\dots{} Они должны бы меня растрогать, а я разозлился\dots{}

И еще он признался:

--- Ничего я тогда не понимал! Надо было судить не по словам, а по делам. Она дарила мне свой аромат, озаряла мою жизнь. Я не должен был бежать. За этими жалкими хитростями и уловками надо было угадать нежность. Цветы так непоследовательны! Но я был слишком молод, я еще не умел любить~\cite{bib:prince}.



\section{Тесты}

\subsection{Списки}
 
\begin{itemize}
    \item первый уровень вложенности
    \begin{itemize}
        \item второй
        \begin{itemize}
            \item третий
            \begin{itemize}
                \item четвертый
            \end{itemize}
        \end{itemize}
    \end{itemize}
\end{itemize}
 
\begin{enumerate}
    \item первый уровень вложенности
    \begin{enumerate}
        \item второй
        \begin{enumerate}
            \item третий
            \begin{enumerate}
                \item четвертый
                \item должно быть б
                \item в
                \item г
                \item д
                \item е
                \item ж
                \item и
            \end{enumerate}
        \end{enumerate}
    \end{enumerate}
\end{enumerate}

\subsection{Плавающие элементы}
 
\begin{table}[htb]
    \caption{Подпись выше таблицы слева}
    \begin{tabular}{ |c|c|c| } 
        \hline
        ячейка 1 & ячейка 2 & ячейка 3 \\ \hline
        ячейка 4 & ячейка 5 & ячейка 6 \\ \hline
    \end{tabular}
    \label{tab:test_label}
\end{table}
 
\begin{figure}[htb]
    \centering
    \includegraphics{mirea_coat_of_arms.png}
    \caption{Подпись ниже рисунка по центру}
    \label{fig:test_label}
\end{figure}
 
См. таблицу~\ref{tab:test_label} на стр.~\pageref{tab:test_label}, рис.~\ref{fig:test_label} на стр.~\pageref{fig:test_label}.

\subsection{Формулы}

\begin{equation}\label{eq:test_label}
    a+b=c
\end{equation}

Представлена формула~\ref{eq:test_label}.

\subsection{Цитирование}

Данный \verb".tex" документ создан на основе рекомендаций~\parencite{bib:recomendations}.

\clearpage
\addcontentsline{toc}{section}{Список использованных источников}
\printbibliography[title={Список использованных источников}]

\end{document}
